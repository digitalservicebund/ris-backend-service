import{ae as I,af as C,ag as X,ah as G,ai as Ce,aj as ie,ak as Me,al as _,am as at,an as dt,ao as O,ap as v,aq as D,ar as Ue,as as Xe,at as Ge,au as ut,av as ct,aw as x,ax as pt,ay as ft,az as ht,aA as se,aB as mt,aC as gt,d as qe,i as V,z as Je,G as bt,a as L,c as R,f as z,t as Te,X as te,F as le,r as re,x as xe,K as Le,b as he,V as Ye,A as ne,aD as yt,aE as wt,aF as Ct,aG as Mt,M as At,l as ke,L as ue,k as W,g as He,aH as St,$ as Tt,a0 as xt,Z as ce}from"./index-a85493d9.js";const Lt=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))$/,kt=/(?:^|\s)((?:\*\*)((?:[^*]+))(?:\*\*))/g,Ht=/(?:^|\s)((?:__)((?:[^__]+))(?:__))$/,Rt=/(?:^|\s)((?:__)((?:[^__]+))(?:__))/g,vt=I.create({name:"bold",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"strong"},{tag:"b",getAttrs:e=>e.style.fontWeight!=="normal"&&null},{style:"font-weight",getAttrs:e=>/^(bold(er)?|[5-9]\d{2,})$/.test(e)&&null}]},renderHTML({HTMLAttributes:e}){return["strong",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setBold:()=>({commands:e})=>e.setMark(this.name),toggleBold:()=>({commands:e})=>e.toggleMark(this.name),unsetBold:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-b":()=>this.editor.commands.toggleBold(),"Mod-B":()=>this.editor.commands.toggleBold()}},addInputRules(){return[X({find:Lt,type:this.type}),X({find:Ht,type:this.type})]},addPasteRules(){return[G({find:kt,type:this.type}),G({find:Rt,type:this.type})]}}),Nt=I.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",C(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const r=Ce(e,this.type);return Object.entries(r).some(([,n])=>!!n)?!0:t.unsetMark(this.name)}}}}),Bt=ie.create({name:"color",addOptions(){return{types:["textStyle"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{color:{default:null,parseHTML:e=>{var t;return(t=e.style.color)===null||t===void 0?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.color?{style:`color: ${e.color}`}:{}}}}]},addCommands(){return{setColor:e=>({chain:t})=>t().setMark("textStyle",{color:e}).run(),unsetColor:()=>({chain:e})=>e().setMark("textStyle",{color:null}).removeEmptyTextStyle().run()}}}),_t=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))$/,zt=/(?:^|\s)((?:\*)((?:[^*]+))(?:\*))/g,It=/(?:^|\s)((?:_)((?:[^_]+))(?:_))$/,Et=/(?:^|\s)((?:_)((?:[^_]+))(?:_))/g,$t=I.create({name:"italic",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"em"},{tag:"i",getAttrs:e=>e.style.fontStyle!=="normal"&&null},{style:"font-style=italic"}]},renderHTML({HTMLAttributes:e}){return["em",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setItalic:()=>({commands:e})=>e.setMark(this.name),toggleItalic:()=>({commands:e})=>e.toggleMark(this.name),unsetItalic:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-i":()=>this.editor.commands.toggleItalic(),"Mod-I":()=>this.editor.commands.toggleItalic()}},addInputRules(){return[X({find:_t,type:this.type}),X({find:It,type:this.type})]},addPasteRules(){return[G({find:zt,type:this.type}),G({find:Et,type:this.type})]}}),Ot=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))$/,Dt=/(?:^|\s)((?:~~)((?:[^~]+))(?:~~))/g,Wt=I.create({name:"strike",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"s"},{tag:"del"},{tag:"strike"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("line-through")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["s",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setStrike:()=>({commands:e})=>e.setMark(this.name),toggleStrike:()=>({commands:e})=>e.toggleMark(this.name),unsetStrike:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-Shift-x":()=>this.editor.commands.toggleStrike()}},addInputRules(){return[X({find:Ot,type:this.type})]},addPasteRules(){return[G({find:Dt,type:this.type})]}});let me,ge;if(typeof WeakMap<"u"){let e=new WeakMap;me=t=>e.get(t),ge=(t,r)=>(e.set(t,r),r)}else{let e=[],t=10,r=0;me=l=>{for(let n=0;n<e.length;n+=2)if(e[n]==l)return e[n+1]},ge=(l,n)=>(r==t&&(r=0),e[r++]=l,e[r++]=n)}class F{constructor(t,r,l,n){this.left=t,this.top=r,this.right=l,this.bottom=n}}class w{constructor(t,r,l,n){this.width=t,this.height=r,this.map=l,this.problems=n}findCell(t){for(let r=0;r<this.map.length;r++){let l=this.map[r];if(l!=t)continue;let n=r%this.width,o=r/this.width|0,s=n+1,a=o+1;for(let i=1;s<this.width&&this.map[r+i]==l;i++)s++;for(let i=1;a<this.height&&this.map[r+this.width*i]==l;i++)a++;return new F(n,o,s,a)}throw new RangeError("No cell with offset "+t+" found")}colCount(t){for(let r=0;r<this.map.length;r++)if(this.map[r]==t)return r%this.width;throw new RangeError("No cell with offset "+t+" found")}nextCell(t,r,l){let{left:n,right:o,top:s,bottom:a}=this.findCell(t);return r=="horiz"?(l<0?n==0:o==this.width)?null:this.map[s*this.width+(l<0?n-1:o)]:(l<0?s==0:a==this.height)?null:this.map[n+this.width*(l<0?s-1:a)]}rectBetween(t,r){let{left:l,right:n,top:o,bottom:s}=this.findCell(t),{left:a,right:i,top:d,bottom:u}=this.findCell(r);return new F(Math.min(l,a),Math.min(o,d),Math.max(n,i),Math.max(s,u))}cellsInRect(t){let r=[],l={};for(let n=t.top;n<t.bottom;n++)for(let o=t.left;o<t.right;o++){let s=n*this.width+o,a=this.map[s];l[a]||(l[a]=!0,(o!=t.left||!o||this.map[s-1]!=a)&&(n!=t.top||!n||this.map[s-this.width]!=a)&&r.push(a))}return r}positionAt(t,r,l){for(let n=0,o=0;;n++){let s=o+l.child(n).nodeSize;if(n==t){let a=r+t*this.width,i=(t+1)*this.width;for(;a<i&&this.map[a]<o;)a++;return a==i?s-1:this.map[a]}o=s}}static get(t){return me(t)||ge(t,Pt(t))}}function Pt(e){if(e.type.spec.tableRole!="table")throw new RangeError("Not a table node: "+e.type.name);let t=Ft(e),r=e.childCount,l=[],n=0,o=null,s=[];for(let d=0,u=t*r;d<u;d++)l[d]=0;for(let d=0,u=0;d<r;d++){let c=e.child(d);u++;for(let f=0;;f++){for(;n<l.length&&l[n]!=0;)n++;if(f==c.childCount)break;let m=c.child(f),{colspan:b,rowspan:S,colwidth:y}=m.attrs;for(let E=0;E<S;E++){if(E+d>=r){(o||(o=[])).push({type:"overlong_rowspan",pos:u,n:S-E});break}let B=n+E*t;for(let T=0;T<b;T++){l[B+T]==0?l[B+T]=u:(o||(o=[])).push({type:"collision",row:d,pos:u,n:b-T});let J=y&&y[T];if(J){let K=(B+T)%t*2,de=s[K];de==null||de!=J&&s[K+1]==1?(s[K]=J,s[K+1]=1):de==J&&s[K+1]++}}}n+=b,u+=m.nodeSize}let p=(d+1)*t,h=0;for(;n<p;)l[n++]==0&&h++;h&&(o||(o=[])).push({type:"missing",row:d,n:h}),u++}let a=new w(t,r,l,o),i=!1;for(let d=0;!i&&d<s.length;d+=2)s[d]!=null&&s[d+1]<r&&(i=!0);return i&&jt(a,s,e),a}function Ft(e){let t=-1,r=!1;for(let l=0;l<e.childCount;l++){let n=e.child(l),o=0;if(r)for(let s=0;s<l;s++){let a=e.child(s);for(let i=0;i<a.childCount;i++){let d=a.child(i);s+d.attrs.rowspan>l&&(o+=d.attrs.colspan)}}for(let s=0;s<n.childCount;s++){let a=n.child(s);o+=a.attrs.colspan,a.attrs.rowspan>1&&(r=!0)}t==-1?t=o:t!=o&&(t=Math.max(t,o))}return t}function jt(e,t,r){e.problems||(e.problems=[]);for(let l=0,n={};l<e.map.length;l++){let o=e.map[l];if(n[o])continue;n[o]=!0;let s=r.nodeAt(o),a=null;for(let i=0;i<s.attrs.colspan;i++){let d=(l+i)%e.width,u=t[d*2];u!=null&&(!s.attrs.colwidth||s.attrs.colwidth[i]!=u)&&((a||(a=Kt(s.attrs)))[i]=u)}a&&e.problems.unshift({type:"colwidth mismatch",pos:o,colwidth:a})}}function Kt(e){if(e.colwidth)return e.colwidth.slice();let t=[];for(let r=0;r<e.colspan;r++)t.push(0);return t}function A(e){let t=e.cached.tableNodeTypes;if(!t){t=e.cached.tableNodeTypes={};for(let r in e.nodes){let l=e.nodes[r],n=l.spec.tableRole;n&&(t[n]=l)}}return t}const $=new Me("selectingCells");function j(e){for(let t=e.depth-1;t>0;t--)if(e.node(t).type.spec.tableRole=="row")return e.node(0).resolve(e.before(t+1));return null}function Vt(e){for(let t=e.depth;t>0;t--){const r=e.node(t).type.spec.tableRole;if(r==="cell"||r==="header_cell")return e.node(t)}return null}function H(e){let t=e.selection.$head;for(let r=t.depth;r>0;r--)if(t.node(r).type.spec.tableRole=="row")return!0;return!1}function ae(e){let t=e.selection;return t.$anchorCell?t.$anchorCell.pos>t.$headCell.pos?t.$anchorCell:t.$headCell:t.node&&t.node.type.spec.tableRole=="cell"?t.$anchor:j(t.$head)||Ut(t.$head)}function Ut(e){for(let t=e.nodeAfter,r=e.pos;t;t=t.firstChild,r++){let l=t.type.spec.tableRole;if(l=="cell"||l=="header_cell")return e.doc.resolve(r)}for(let t=e.nodeBefore,r=e.pos;t;t=t.lastChild,r--){let l=t.type.spec.tableRole;if(l=="cell"||l=="header_cell")return e.doc.resolve(r-t.nodeSize)}}function be(e){return e.parent.type.spec.tableRole=="row"&&e.nodeAfter}function Xt(e){return e.node(0).resolve(e.pos+e.nodeAfter.nodeSize)}function Ae(e,t){return e.depth==t.depth&&e.pos>=t.start(-1)&&e.pos<=t.end(-1)}function Ze(e,t,r){let l=e.start(-1),o=w.get(e.node(-1)).nextCell(e.pos-l,t,r);return o==null?null:e.node(0).resolve(l+o)}function M(e,t,r){let l={};for(let n in e)l[n]=e[n];return l[t]=r,l}function P(e,t,r=1){let l=M(e,"colspan",e.colspan-r);return l.colwidth&&(l.colwidth=l.colwidth.slice(),l.colwidth.splice(t,r),l.colwidth.some(n=>n>0)||(l.colwidth=null)),l}function Qe(e,t,r=1){let l=M(e,"colspan",e.colspan+r);if(l.colwidth){l.colwidth=l.colwidth.slice();for(let n=0;n<r;n++)l.colwidth.splice(t,0,0)}return l}function Gt(e,t,r){let l=A(t.type.schema).header_cell;for(let n=0;n<e.height;n++)if(t.nodeAt(e.map[r+n*e.width]).type!=l)return!1;return!0}class g extends _{constructor(t,r=t){let l=t.node(-1),n=w.get(l),o=t.start(-1),s=n.rectBetween(t.pos-o,r.pos-o),a=t.node(0),i=n.cellsInRect(s).filter(u=>u!=r.pos-o);i.unshift(r.pos-o);let d=i.map(u=>{let c=l.nodeAt(u),p=u+o+1;return new dt(a.resolve(p),a.resolve(p+c.content.size))});super(d[0].$from,d[0].$to,d),this.$anchorCell=t,this.$headCell=r}map(t,r){let l=t.resolve(r.map(this.$anchorCell.pos)),n=t.resolve(r.map(this.$headCell.pos));if(be(l)&&be(n)&&Ae(l,n)){let o=this.$anchorCell.node(-1)!=l.node(-1);return o&&this.isRowSelection()?g.rowSelection(l,n):o&&this.isColSelection()?g.colSelection(l,n):new g(l,n)}return O.between(l,n)}content(){let t=this.$anchorCell.node(-1),r=w.get(t),l=this.$anchorCell.start(-1),n=r.rectBetween(this.$anchorCell.pos-l,this.$headCell.pos-l),o={},s=[];for(let i=n.top;i<n.bottom;i++){let d=[];for(let u=i*r.width+n.left,c=n.left;c<n.right;c++,u++){let p=r.map[u];if(!o[p]){o[p]=!0;let h=r.findCell(p),f=t.nodeAt(p),m=n.left-h.left,b=h.right-n.right;if(m>0||b>0){let S=f.attrs;m>0&&(S=P(S,0,m)),b>0&&(S=P(S,S.colspan-b,b)),h.left<n.left?f=f.type.createAndFill(S):f=f.type.create(S,f.content)}if(h.top<n.top||h.bottom>n.bottom){let S=M(f.attrs,"rowspan",Math.min(h.bottom,n.bottom)-Math.max(h.top,n.top));h.top<n.top?f=f.type.createAndFill(S):f=f.type.create(S,f.content)}d.push(f)}}s.push(t.child(i).copy(v.from(d)))}const a=this.isColSelection()&&this.isRowSelection()?t:s;return new D(v.from(a),1,1)}replace(t,r=D.empty){let l=t.steps.length,n=this.ranges;for(let s=0;s<n.length;s++){let{$from:a,$to:i}=n[s],d=t.mapping.slice(l);t.replace(d.map(a.pos),d.map(i.pos),s?D.empty:r)}let o=_.findFrom(t.doc.resolve(t.mapping.slice(l).map(this.to)),-1);o&&t.setSelection(o)}replaceWith(t,r){this.replace(t,new D(v.from(r),0,0))}forEachCell(t){let r=this.$anchorCell.node(-1),l=w.get(r),n=this.$anchorCell.start(-1),o=l.cellsInRect(l.rectBetween(this.$anchorCell.pos-n,this.$headCell.pos-n));for(let s=0;s<o.length;s++)t(r.nodeAt(o[s]),n+o[s])}isColSelection(){let t=this.$anchorCell.index(-1),r=this.$headCell.index(-1);if(Math.min(t,r)>0)return!1;let l=t+this.$anchorCell.nodeAfter.attrs.rowspan,n=r+this.$headCell.nodeAfter.attrs.rowspan;return Math.max(l,n)==this.$headCell.node(-1).childCount}static colSelection(t,r=t){let l=w.get(t.node(-1)),n=t.start(-1),o=l.findCell(t.pos-n),s=l.findCell(r.pos-n),a=t.node(0);return o.top<=s.top?(o.top>0&&(t=a.resolve(n+l.map[o.left])),s.bottom<l.height&&(r=a.resolve(n+l.map[l.width*(l.height-1)+s.right-1]))):(s.top>0&&(r=a.resolve(n+l.map[s.left])),o.bottom<l.height&&(t=a.resolve(n+l.map[l.width*(l.height-1)+o.right-1]))),new g(t,r)}isRowSelection(){let t=w.get(this.$anchorCell.node(-1)),r=this.$anchorCell.start(-1),l=t.colCount(this.$anchorCell.pos-r),n=t.colCount(this.$headCell.pos-r);if(Math.min(l,n)>0)return!1;let o=l+this.$anchorCell.nodeAfter.attrs.colspan,s=n+this.$headCell.nodeAfter.attrs.colspan;return Math.max(o,s)==t.width}eq(t){return t instanceof g&&t.$anchorCell.pos==this.$anchorCell.pos&&t.$headCell.pos==this.$headCell.pos}static rowSelection(t,r=t){let l=w.get(t.node(-1)),n=t.start(-1),o=l.findCell(t.pos-n),s=l.findCell(r.pos-n),a=t.node(0);return o.left<=s.left?(o.left>0&&(t=a.resolve(n+l.map[o.top*l.width])),s.right<l.width&&(r=a.resolve(n+l.map[l.width*(s.top+1)-1]))):(s.left>0&&(r=a.resolve(n+l.map[s.top*l.width])),o.right<l.width&&(t=a.resolve(n+l.map[l.width*(o.top+1)-1]))),new g(t,r)}toJSON(){return{type:"cell",anchor:this.$anchorCell.pos,head:this.$headCell.pos}}static fromJSON(t,r){return new g(t.resolve(r.anchor),t.resolve(r.head))}static create(t,r,l=r){return new g(t.resolve(r),t.resolve(l))}getBookmark(){return new Se(this.$anchorCell.pos,this.$headCell.pos)}}g.prototype.visible=!1;_.jsonID("cell",g);class Se{constructor(t,r){this.anchor=t,this.head=r}map(t){return new Se(t.map(this.anchor),t.map(this.head))}resolve(t){let r=t.resolve(this.anchor),l=t.resolve(this.head);return r.parent.type.spec.tableRole=="row"&&l.parent.type.spec.tableRole=="row"&&r.index()<r.parent.childCount&&l.index()<l.parent.childCount&&Ae(r,l)?new g(r,l):_.near(l,1)}}function qt(e){if(!(e.selection instanceof g))return null;let t=[];return e.selection.forEachCell((r,l)=>{t.push(Xe.node(l,l+r.nodeSize,{class:"selectedCell"}))}),Ge.create(e.doc,t)}function Jt({$from:e,$to:t}){if(e.pos==t.pos||e.pos<e.pos-6)return!1;let r=e.pos,l=t.pos,n=e.depth;for(;n>=0&&!(e.after(n+1)<e.end(n));n--,r++);for(let o=t.depth;o>=0&&!(t.before(o+1)>t.start(o));o--,l--);return r==l&&/row|table/.test(e.node(n).type.spec.tableRole)}function Yt({$from:e,$to:t}){let r,l;for(let n=e.depth;n>0;n--){let o=e.node(n);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){r=o;break}}for(let n=t.depth;n>0;n--){let o=t.node(n);if(o.type.spec.tableRole==="cell"||o.type.spec.tableRole==="header_cell"){l=o;break}}return r!==l&&t.parentOffset===0}function Zt(e,t,r){let l=(t||e).selection,n=(t||e).doc,o,s;if(l instanceof ut&&(s=l.node.type.spec.tableRole)){if(s=="cell"||s=="header_cell")o=g.create(n,l.from);else if(s=="row"){let a=n.resolve(l.from+1);o=g.rowSelection(a,a)}else if(!r){let a=w.get(l.node),i=l.from+1,d=i+a.map[a.width*a.height-1];o=g.create(n,i+1,d)}}else l instanceof O&&Jt(l)?o=O.create(n,l.from):l instanceof O&&Yt(l)&&(o=O.create(n,l.$from.start(),l.$from.end()));return o&&(t||(t=e.tr)).setSelection(o),t}function Qt(e){if(!e.size)return null;let{content:t,openStart:r,openEnd:l}=e;for(;t.childCount==1&&(r>0&&l>0||t.firstChild.type.spec.tableRole=="table");)r--,l--,t=t.firstChild.content;let n=t.firstChild,o=n.type.spec.tableRole,s=n.type.schema,a=[];if(o=="row")for(let i=0;i<t.childCount;i++){let d=t.child(i).content,u=i?0:Math.max(0,r-1),c=i<t.childCount-1?0:Math.max(0,l-1);(u||c)&&(d=ye(A(s).row,new D(d,u,c)).content),a.push(d)}else if(o=="cell"||o=="header_cell")a.push(r||l?ye(A(s).row,new D(t,r,l)).content:t);else return null;return el(s,a)}function el(e,t){let r=[];for(let n=0;n<t.length;n++){let o=t[n];for(let s=o.childCount-1;s>=0;s--){let{rowspan:a,colspan:i}=o.child(s).attrs;for(let d=n;d<n+a;d++)r[d]=(r[d]||0)+i}}let l=0;for(let n=0;n<r.length;n++)l=Math.max(l,r[n]);for(let n=0;n<r.length;n++)if(n>=t.length&&t.push(v.empty),r[n]<l){let o=A(e).cell.createAndFill(),s=[];for(let a=r[n];a<l;a++)s.push(o);t[n]=t[n].append(v.from(s))}return{height:t.length,width:l,rows:t}}function ye(e,t){let r=e.createAndFill();return new ct(r).replace(0,r.content.size,t).doc}function tl({width:e,height:t,rows:r},l,n){if(e!=l){let o=[],s=[];for(let a=0;a<r.length;a++){let i=r[a],d=[];for(let u=o[a]||0,c=0;u<l;c++){let p=i.child(c%i.childCount);u+p.attrs.colspan>l&&(p=p.type.create(P(p.attrs,p.attrs.colspan,u+p.attrs.colspan-l),p.content)),d.push(p),u+=p.attrs.colspan;for(let h=1;h<p.attrs.rowspan;h++)o[a+h]=(o[a+h]||0)+p.attrs.colspan}s.push(v.from(d))}r=s,e=l}if(t!=n){let o=[];for(let s=0,a=0;s<n;s++,a++){let i=[],d=r[a%t];for(let u=0;u<d.childCount;u++){let c=d.child(u);s+c.attrs.rowspan>n&&(c=c.type.create(M(c.attrs,"rowspan",Math.max(1,n-c.attrs.rowspan)),c.content)),i.push(c)}o.push(v.from(i))}r=o,t=n}return{width:e,height:t,rows:r}}function ll(e,t,r,l,n,o,s){let a=e.doc.type.schema,i=A(a),d,u;if(n>t.width)for(let c=0,p=0;c<t.height;c++){let h=r.child(c);p+=h.nodeSize;let f=[],m;h.lastChild==null||h.lastChild.type==i.cell?m=d||(d=i.cell.createAndFill()):m=u||(u=i.header_cell.createAndFill());for(let b=t.width;b<n;b++)f.push(m);e.insert(e.mapping.slice(s).map(p-1+l),f)}if(o>t.height){let c=[];for(let f=0,m=(t.height-1)*t.width;f<Math.max(t.width,n);f++){let b=f>=t.width?!1:r.nodeAt(t.map[m+f]).type==i.header_cell;c.push(b?u||(u=i.header_cell.createAndFill()):d||(d=i.cell.createAndFill()))}let p=i.row.create(null,v.from(c)),h=[];for(let f=t.height;f<o;f++)h.push(p);e.insert(e.mapping.slice(s).map(l+r.nodeSize-2),h)}return!!(d||u)}function Re(e,t,r,l,n,o,s,a){if(s==0||s==t.height)return!1;let i=!1;for(let d=n;d<o;d++){let u=s*t.width+d,c=t.map[u];if(t.map[u-t.width]==c){i=!0;let p=r.nodeAt(c),{top:h,left:f}=t.findCell(c);e.setNodeMarkup(e.mapping.slice(a).map(c+l),null,M(p.attrs,"rowspan",s-h)),e.insert(e.mapping.slice(a).map(t.positionAt(s,f,r)),p.type.createAndFill(M(p.attrs,"rowspan",h+p.attrs.rowspan-s))),d+=p.attrs.colspan-1}}return i}function ve(e,t,r,l,n,o,s,a){if(s==0||s==t.width)return!1;let i=!1;for(let d=n;d<o;d++){let u=d*t.width+s,c=t.map[u];if(t.map[u-1]==c){i=!0;let p=r.nodeAt(c),h=t.colCount(c),f=e.mapping.slice(a).map(c+l);e.setNodeMarkup(f,null,P(p.attrs,s-h,p.attrs.colspan-(s-h))),e.insert(f+p.nodeSize,p.type.createAndFill(P(p.attrs,0,s-h))),d+=p.attrs.rowspan-1}}return i}function Ne(e,t,r,l,n){let o=r?e.doc.nodeAt(r-1):e.doc,s=w.get(o),{top:a,left:i}=l,d=i+n.width,u=a+n.height,c=e.tr,p=0;function h(){o=r?c.doc.nodeAt(r-1):c.doc,s=w.get(o),p=c.mapping.maps.length}ll(c,s,o,r,d,u,p)&&h(),Re(c,s,o,r,i,d,a,p)&&h(),Re(c,s,o,r,i,d,u,p)&&h(),ve(c,s,o,r,a,u,i,p)&&h(),ve(c,s,o,r,a,u,d,p)&&h();for(let f=a;f<u;f++){let m=s.positionAt(f,i,o),b=s.positionAt(f,d,o);c.replace(c.mapping.slice(p).map(m+r),c.mapping.slice(p).map(b+r),new D(n.rows[f-a],0,0))}h(),c.setSelection(new g(c.doc.resolve(r+s.positionAt(a,i,o)),c.doc.resolve(r+s.positionAt(u-1,d-1,o)))),t(c)}const rl=at({ArrowLeft:Y("horiz",-1),ArrowRight:Y("horiz",1),ArrowUp:Y("vert",-1),ArrowDown:Y("vert",1),"Shift-ArrowLeft":Z("horiz",-1),"Shift-ArrowRight":Z("horiz",1),"Shift-ArrowUp":Z("vert",-1),"Shift-ArrowDown":Z("vert",1),Backspace:Q,"Mod-Backspace":Q,Delete:Q,"Mod-Delete":Q});function oe(e,t,r){return r.eq(e.selection)?!1:(t&&t(e.tr.setSelection(r).scrollIntoView()),!0)}function Y(e,t){return(r,l,n)=>{let o=r.selection;if(o instanceof g)return oe(r,l,_.near(o.$headCell,t));if(e!="horiz"&&!o.empty)return!1;let s=et(n,e,t);if(s==null)return!1;if(e=="horiz")return oe(r,l,_.near(r.doc.resolve(o.head+t),t));{let a=r.doc.resolve(s),i=Ze(a,e,t),d;return i?d=_.near(i,1):t<0?d=_.near(r.doc.resolve(a.before(-1)),-1):d=_.near(r.doc.resolve(a.after(-1)),1),oe(r,l,d)}}}function Z(e,t){return(r,l,n)=>{let o=r.selection;if(!(o instanceof g)){let a=et(n,e,t);if(a==null)return!1;o=new g(r.doc.resolve(a))}let s=Ze(o.$headCell,e,t);return s?oe(r,l,new g(o.$anchorCell,s)):!1}}function Q(e,t){let r=e.selection;if(!(r instanceof g))return!1;if(t){let l=e.tr,n=A(e.schema).cell.createAndFill().content;r.forEachCell((o,s)=>{o.content.eq(n)||l.replace(l.mapping.map(s+1),l.mapping.map(s+o.nodeSize-1),new D(n,0,0))}),l.docChanged&&t(l)}return!0}function nl(e,t){let r=e.state.doc,l=j(r.resolve(t));return l?(e.dispatch(e.state.tr.setSelection(new g(l))),!0):!1}function ol(e,t,r){if(!H(e.state))return!1;let l=Qt(r),n=e.state.selection;if(n instanceof g){l||(l={width:1,height:1,rows:[v.from(ye(A(e.state.schema).cell,r))]});let o=n.$anchorCell.node(-1),s=n.$anchorCell.start(-1),a=w.get(o).rectBetween(n.$anchorCell.pos-s,n.$headCell.pos-s);return l=tl(l,a.right-a.left,a.bottom-a.top),Ne(e.state,e.dispatch,s,a,l),!0}else if(l){let o=ae(e.state),s=o.start(-1);return Ne(e.state,e.dispatch,s,w.get(o.node(-1)).findCell(o.pos-s),l),!0}else return!1}function sl(e,t){if(t.ctrlKey||t.metaKey)return;let r=Be(e,t.target),l;if(t.shiftKey&&e.state.selection instanceof g)n(e.state.selection.$anchorCell,t),t.preventDefault();else if(t.shiftKey&&r&&(l=j(e.state.selection.$anchor))!=null&&pe(e,t).pos!=l.pos)n(l,t),t.preventDefault();else if(!r)return;function n(a,i){let d=pe(e,i),u=$.getState(e.state)==null;if(!d||!Ae(a,d))if(u)d=a;else return;let c=new g(a,d);if(u||!e.state.selection.eq(c)){let p=e.state.tr.setSelection(c);u&&p.setMeta($,a.pos),e.dispatch(p)}}function o(){e.root.removeEventListener("mouseup",o),e.root.removeEventListener("dragstart",o),e.root.removeEventListener("mousemove",s),$.getState(e.state)!=null&&e.dispatch(e.state.tr.setMeta($,-1))}function s(a){let i=$.getState(e.state),d;if(i!=null)d=e.state.doc.resolve(i);else if(Be(e,a.target)!=r&&(d=pe(e,t),!d))return o();d&&n(d,a)}e.root.addEventListener("mouseup",o),e.root.addEventListener("dragstart",o),e.root.addEventListener("mousemove",s)}function et(e,t,r){if(!(e.state.selection instanceof O))return null;let{$head:l}=e.state.selection;for(let n=l.depth-1;n>=0;n--){let o=l.node(n);if((r<0?l.index(n):l.indexAfter(n))!=(r<0?0:o.childCount))return null;if(o.type.spec.tableRole=="cell"||o.type.spec.tableRole=="header_cell"){let a=l.before(n),i=t=="vert"?r>0?"down":"up":r>0?"right":"left";return e.endOfTextblock(i)?a:null}}return null}function Be(e,t){for(;t&&t!=e.dom;t=t.parentNode)if(t.nodeName=="TD"||t.nodeName=="TH")return t}function pe(e,t){let r=e.posAtCoords({left:t.clientX,top:t.clientY});return r&&r?j(e.state.doc.resolve(r.pos)):null}const il=new Me("fix-tables");function tt(e,t,r,l){let n=e.childCount,o=t.childCount;e:for(let s=0,a=0;s<o;s++){let i=t.child(s);for(let d=a,u=Math.min(n,s+3);d<u;d++)if(e.child(d)==i){a=d+1,r+=i.nodeSize;continue e}l(i,r),a<n&&e.child(a).sameMarkup(i)?tt(e.child(a),i,r+1,l):i.nodesBetween(0,i.content.size,l,r+1),r+=i.nodeSize}}function lt(e,t){let r,l=(n,o)=>{n.type.spec.tableRole=="table"&&(r=al(e,n,o,r))};return t?t.doc!=e.doc&&tt(t.doc,e.doc,0,l):e.doc.descendants(l),r}function al(e,t,r,l){let n=w.get(t);if(!n.problems)return l;l||(l=e.tr);let o=[];for(let i=0;i<n.height;i++)o.push(0);for(let i=0;i<n.problems.length;i++){let d=n.problems[i];if(d.type=="collision"){let u=t.nodeAt(d.pos);for(let c=0;c<u.attrs.rowspan;c++)o[d.row+c]+=d.n;l.setNodeMarkup(l.mapping.map(r+1+d.pos),null,P(u.attrs,u.attrs.colspan-d.n,d.n))}else if(d.type=="missing")o[d.row]+=d.n;else if(d.type=="overlong_rowspan"){let u=t.nodeAt(d.pos);l.setNodeMarkup(l.mapping.map(r+1+d.pos),null,M(u.attrs,"rowspan",u.attrs.rowspan-d.n))}else if(d.type=="colwidth mismatch"){let u=t.nodeAt(d.pos);l.setNodeMarkup(l.mapping.map(r+1+d.pos),null,M(u.attrs,"colwidth",d.colwidth))}}let s,a;for(let i=0;i<o.length;i++)o[i]&&(s==null&&(s=i),a=i);for(let i=0,d=r+1;i<n.height;i++){let u=t.child(i),c=d+u.nodeSize,p=o[i];if(p>0){let h="cell";u.firstChild&&(h=u.firstChild.type.spec.tableRole);let f=[];for(let b=0;b<p;b++)f.push(A(e.schema)[h].createAndFill());let m=(i==0||s==i-1)&&a==i?d+1:c-1;l.insert(l.mapping.map(m),f)}d=c}return l.setMeta(il,{fixTables:!0})}function N(e){let t=e.selection,r=ae(e),l=r.node(-1),n=r.start(-1),o=w.get(l),s;return t instanceof g?s=o.rectBetween(t.$anchorCell.pos-n,t.$headCell.pos-n):s=o.findCell(r.pos-n),s.tableStart=n,s.map=o,s.table=l,s}function rt(e,{map:t,tableStart:r,table:l},n){let o=n>0?-1:0;Gt(t,l,n+o)&&(o=n==0||n==t.width?null:0);for(let s=0;s<t.height;s++){let a=s*t.width+n;if(n>0&&n<t.width&&t.map[a-1]==t.map[a]){let i=t.map[a],d=l.nodeAt(i);e.setNodeMarkup(e.mapping.map(r+i),null,Qe(d.attrs,n-t.colCount(i))),s+=d.attrs.rowspan-1}else{let i=o==null?A(l.type.schema).cell:l.nodeAt(t.map[a+o]).type,d=t.positionAt(s,n,l);e.insert(e.mapping.map(r+d),i.createAndFill())}}return e}function dl(e,t){if(!H(e))return!1;if(t){let r=N(e);t(rt(e.tr,r,r.left))}return!0}function ul(e,t){if(!H(e))return!1;if(t){let r=N(e);t(rt(e.tr,r,r.right))}return!0}function cl(e,{map:t,table:r,tableStart:l},n){let o=e.mapping.maps.length;for(let s=0;s<t.height;){let a=s*t.width+n,i=t.map[a],d=r.nodeAt(i);if(n>0&&t.map[a-1]==i||n<t.width-1&&t.map[a+1]==i)e.setNodeMarkup(e.mapping.slice(o).map(l+i),null,P(d.attrs,n-t.colCount(i)));else{let u=e.mapping.slice(o).map(l+i);e.delete(u,u+d.nodeSize)}s+=d.attrs.rowspan}}function pl(e,t){if(!H(e))return!1;if(t){let r=N(e),l=e.tr;if(r.left==0&&r.right==r.map.width)return!1;for(let n=r.right-1;cl(l,r,n),n!=r.left;n--)r.table=r.tableStart?l.doc.nodeAt(r.tableStart-1):l.doc,r.map=w.get(r.table);t(l)}return!0}function fl(e,t,r){let l=A(t.type.schema).header_cell;for(let n=0;n<e.width;n++)if(t.nodeAt(e.map[n+r*e.width]).type!=l)return!1;return!0}function nt(e,{map:t,tableStart:r,table:l},n){let o=r;for(let i=0;i<n;i++)o+=l.child(i).nodeSize;let s=[],a=n>0?-1:0;fl(t,l,n+a)&&(a=n==0||n==t.height?null:0);for(let i=0,d=t.width*n;i<t.width;i++,d++)if(n>0&&n<t.height&&t.map[d]==t.map[d-t.width]){let u=t.map[d],c=l.nodeAt(u).attrs;e.setNodeMarkup(r+u,null,M(c,"rowspan",c.rowspan+1)),i+=c.colspan-1}else{let u=a==null?A(l.type.schema).cell:l.nodeAt(t.map[d+a*t.width]).type;s.push(u.createAndFill())}return e.insert(o,A(l.type.schema).row.create(null,s)),e}function hl(e,t){if(!H(e))return!1;if(t){let r=N(e);t(nt(e.tr,r,r.top))}return!0}function ml(e,t){if(!H(e))return!1;if(t){let r=N(e);t(nt(e.tr,r,r.bottom))}return!0}function gl(e,{map:t,table:r,tableStart:l},n){let o=0;for(let i=0;i<n;i++)o+=r.child(i).nodeSize;let s=o+r.child(n).nodeSize,a=e.mapping.maps.length;e.delete(o+l,s+l);for(let i=0,d=n*t.width;i<t.width;i++,d++){let u=t.map[d];if(n>0&&u==t.map[d-t.width]){let c=r.nodeAt(u).attrs;e.setNodeMarkup(e.mapping.slice(a).map(u+l),null,M(c,"rowspan",c.rowspan-1)),i+=c.colspan-1}else if(n<t.width&&u==t.map[d+t.width]){let c=r.nodeAt(u),p=c.type.create(M(c.attrs,"rowspan",c.attrs.rowspan-1),c.content),h=t.positionAt(n+1,i,r);e.insert(e.mapping.slice(a).map(l+h),p),i+=c.attrs.colspan-1}}}function bl(e,t){if(!H(e))return!1;if(t){let r=N(e),l=e.tr;if(r.top==0&&r.bottom==r.map.height)return!1;for(let n=r.bottom-1;gl(l,r,n),n!=r.top;n--)r.table=r.tableStart?l.doc.nodeAt(r.tableStart-1):l.doc,r.map=w.get(r.table);t(l)}return!0}function _e(e){let t=e.content;return t.childCount==1&&t.firstChild.isTextblock&&t.firstChild.childCount==0}function yl({width:e,height:t,map:r},l){let n=l.top*e+l.left,o=n,s=(l.bottom-1)*e+l.left,a=n+(l.right-l.left-1);for(let i=l.top;i<l.bottom;i++){if(l.left>0&&r[o]==r[o-1]||l.right<e&&r[a]==r[a+1])return!0;o+=e,a+=e}for(let i=l.left;i<l.right;i++){if(l.top>0&&r[n]==r[n-e]||l.bottom<t&&r[s]==r[s+e])return!0;n++,s++}return!1}function ze(e,t){let r=e.selection;if(!(r instanceof g)||r.$anchorCell.pos==r.$headCell.pos)return!1;let l=N(e),{map:n}=l;if(yl(n,l))return!1;if(t){let o=e.tr,s={},a=v.empty,i,d;for(let u=l.top;u<l.bottom;u++)for(let c=l.left;c<l.right;c++){let p=n.map[u*n.width+c],h=l.table.nodeAt(p);if(!s[p])if(s[p]=!0,i==null)i=p,d=h;else{_e(h)||(a=a.append(h.content));let f=o.mapping.map(p+l.tableStart);o.delete(f,f+h.nodeSize)}}if(o.setNodeMarkup(i+l.tableStart,null,M(Qe(d.attrs,d.attrs.colspan,l.right-l.left-d.attrs.colspan),"rowspan",l.bottom-l.top)),a.size){let u=i+1+d.content.size,c=_e(d)?i+1:u;o.replaceWith(c+l.tableStart,u+l.tableStart,a)}o.setSelection(new g(o.doc.resolve(i+l.tableStart))),t(o)}return!0}function Ie(e,t){const r=A(e.schema);return wl(({node:l})=>r[l.type.spec.tableRole])(e,t)}function wl(e){return(t,r)=>{let l=t.selection,n,o;if(l instanceof g){if(l.$anchorCell.pos!=l.$headCell.pos)return!1;n=l.$anchorCell.nodeAfter,o=l.$anchorCell.pos}else{if(n=Vt(l.$from),!n)return!1;o=j(l.$from).pos}if(n.attrs.colspan==1&&n.attrs.rowspan==1)return!1;if(r){let s=n.attrs,a=[],i=s.colwidth;s.rowspan>1&&(s=M(s,"rowspan",1)),s.colspan>1&&(s=M(s,"colspan",1));let d=N(t),u=t.tr;for(let p=0;p<d.right-d.left;p++)a.push(i?M(s,"colwidth",i&&i[p]?[i[p]]:null):s);let c;for(let p=d.top;p<d.bottom;p++){let h=d.map.positionAt(p,d.left,d.table);p==d.top&&(h+=n.nodeSize);for(let f=d.left,m=0;f<d.right;f++,m++)f==d.left&&p==d.top||u.insert(c=u.mapping.map(h+d.tableStart,1),e({node:n,row:p,col:f}).createAndFill(a[m]))}u.setNodeMarkup(o,e({node:n,row:d.top,col:d.left}),a[0]),l instanceof g&&u.setSelection(new g(u.doc.resolve(l.$anchorCell.pos),c&&u.doc.resolve(c))),r(u)}return!0}}function Cl(e,t){return function(r,l){if(!H(r))return!1;let n=ae(r);if(n.nodeAfter.attrs[e]===t)return!1;if(l){let o=r.tr;r.selection instanceof g?r.selection.forEachCell((s,a)=>{s.attrs[e]!==t&&o.setNodeMarkup(a,null,M(s.attrs,e,t))}):o.setNodeMarkup(n.pos,null,M(n.nodeAfter.attrs,e,t)),l(o)}return!0}}function Ml(e){return function(t,r){if(!H(t))return!1;if(r){let l=A(t.schema),n=N(t),o=t.tr,s=n.map.cellsInRect(e=="column"?new F(n.left,0,n.right,n.map.height):e=="row"?new F(0,n.top,n.map.width,n.bottom):n),a=s.map(i=>n.table.nodeAt(i));for(let i=0;i<s.length;i++)a[i].type==l.header_cell&&o.setNodeMarkup(n.tableStart+s[i],l.cell,a[i].attrs);if(o.steps.length==0)for(let i=0;i<s.length;i++)o.setNodeMarkup(n.tableStart+s[i],l.header_cell,a[i].attrs);r(o)}return!0}}function Ee(e,t,r){const l=t.map.cellsInRect({left:0,top:0,right:e=="row"?t.map.width:1,bottom:e=="column"?t.map.height:1});for(let n=0;n<l.length;n++){const o=t.table.nodeAt(l[n]);if(o&&o.type!==r.header_cell)return!1}return!0}function q(e,t){return t=t||{useDeprecatedLogic:!1},t.useDeprecatedLogic?Ml(e):function(r,l){if(!H(r))return!1;if(l){let n=A(r.schema),o=N(r),s=r.tr,a=Ee("row",o,n),i=Ee("column",o,n),u=(e==="column"?a:e==="row"?i:!1)?1:0,c=e=="column"?new F(0,u,1,o.map.height):e=="row"?new F(u,0,o.map.width,1):o,p=e=="column"?i?n.cell:n.header_cell:e=="row"?a?n.cell:n.header_cell:n.cell;o.map.cellsInRect(c).forEach(h=>{const f=h+o.tableStart,m=s.doc.nodeAt(f);m&&s.setNodeMarkup(f,p,m.attrs)}),l(s)}return!0}}q("row",{useDeprecatedLogic:!0});q("column",{useDeprecatedLogic:!0});let Al=q("cell",{useDeprecatedLogic:!0});function Sl(e,t){if(t<0){let r=e.nodeBefore;if(r)return e.pos-r.nodeSize;for(let l=e.index(-1)-1,n=e.before();l>=0;l--){let o=e.node(-1).child(l);if(o.childCount)return n-1-o.lastChild.nodeSize;n-=o.nodeSize}}else{if(e.index()<e.parent.childCount-1)return e.pos+e.nodeAfter.nodeSize;let r=e.node(-1);for(let l=e.indexAfter(-1),n=e.after();l<r.childCount;l++){let o=r.child(l);if(o.childCount)return n+1;n+=o.nodeSize}}}function $e(e){return function(t,r){if(!H(t))return!1;let l=Sl(ae(t),e);if(l!=null){if(r){let n=t.doc.resolve(l);r(t.tr.setSelection(O.between(n,Xt(n))).scrollIntoView())}return!0}}}function Tl(e,t){let r=e.selection.$anchor;for(let l=r.depth;l>0;l--)if(r.node(l).type.spec.tableRole=="table")return t&&t(e.tr.delete(r.before(l),r.after(l)).scrollIntoView()),!0;return!1}let xl=class{constructor(t,r){this.node=t,this.cellMinWidth=r,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),we(t,this.colgroup,this.table,r),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!=this.node.type?!1:(this.node=t,we(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type=="attributes"&&(t.target==this.table||this.colgroup.contains(t.target))}};function we(e,t,r,l,n,o){let s=0,a=!0,i=t.firstChild,d=e.firstChild;for(let u=0,c=0;u<d.childCount;u++){let{colspan:p,colwidth:h}=d.child(u).attrs;for(let f=0;f<p;f++,c++){let m=n==c?o:h&&h[f],b=m?m+"px":"";s+=m||l,m||(a=!1),i?(i.style.width!=b&&(i.style.width=b),i=i.nextSibling):t.appendChild(document.createElement("col")).style.width=b}}for(;i;){let u=i.nextSibling;i.parentNode.removeChild(i),i=u}a?(r.style.width=s+"px",r.style.minWidth=""):(r.style.width="",r.style.minWidth=s+"px")}const k=new Me("tableColumnResizing");function Ll({handleWidth:e=5,cellMinWidth:t=25,View:r=xl,lastColumnResizable:l=!0}={}){return new Ue({key:k,state:{init(o,s){return this.spec.props.nodeViews[A(s.schema).table.name]=(a,i)=>new r(a,t,i),new U(-1,!1)},apply(o,s){return s.apply(o)}},props:{attributes(o){return k.getState(o).activeHandle>-1?{class:"resize-cursor"}:null},handleDOMEvents:{mousemove(o,s){kl(o,s,e,t,l)},mouseleave(o){Hl(o)},mousedown(o,s){Rl(o,s,t)}},decorations(o){let s=k.getState(o);if(s.activeHandle>-1)return Il(o,s.activeHandle)},nodeViews:{}}})}class U{constructor(t,r){this.activeHandle=t,this.dragging=r}apply(t){let r=this,l=t.getMeta(k);if(l&&l.setHandle!=null)return new U(l.setHandle,null);if(l&&l.setDragging!==void 0)return new U(r.activeHandle,l.setDragging);if(r.activeHandle>-1&&t.docChanged){let n=t.mapping.map(r.activeHandle,-1);be(t.doc.resolve(n))||(n=null),r=new U(n,r.dragging)}return r}}function kl(e,t,r,l,n){let o=k.getState(e.state);if(!o.dragging){let s=Nl(t.target),a=-1;if(s){let{left:i,right:d}=s.getBoundingClientRect();t.clientX-i<=r?a=Oe(e,t,"left"):d-t.clientX<=r&&(a=Oe(e,t,"right"))}if(a!=o.activeHandle){if(!n&&a!==-1){let i=e.state.doc.resolve(a),d=i.node(-1),u=w.get(d),c=i.start(-1);if(u.colCount(i.pos-c)+i.nodeAfter.attrs.colspan-1==u.width-1)return}ot(e,a)}}}function Hl(e){let t=k.getState(e.state);t.activeHandle>-1&&!t.dragging&&ot(e,-1)}function Rl(e,t,r){let l=k.getState(e.state);if(l.activeHandle==-1||l.dragging)return!1;let n=e.state.doc.nodeAt(l.activeHandle),o=vl(e,l.activeHandle,n.attrs);e.dispatch(e.state.tr.setMeta(k,{setDragging:{startX:t.clientX,startWidth:o}}));function s(i){window.removeEventListener("mouseup",s),window.removeEventListener("mousemove",a);let d=k.getState(e.state);d.dragging&&(Bl(e,d.activeHandle,De(d.dragging,i,r)),e.dispatch(e.state.tr.setMeta(k,{setDragging:null})))}function a(i){if(!i.which)return s(i);let d=k.getState(e.state),u=De(d.dragging,i,r);_l(e,d.activeHandle,u,r)}return window.addEventListener("mouseup",s),window.addEventListener("mousemove",a),t.preventDefault(),!0}function vl(e,t,{colspan:r,colwidth:l}){let n=l&&l[l.length-1];if(n)return n;let o=e.domAtPos(t),a=o.node.childNodes[o.offset].offsetWidth,i=r;if(l)for(let d=0;d<r;d++)l[d]&&(a-=l[d],i--);return a/i}function Nl(e){for(;e&&e.nodeName!="TD"&&e.nodeName!="TH";)e=e.classList.contains("ProseMirror")?null:e.parentNode;return e}function Oe(e,t,r){let l=e.posAtCoords({left:t.clientX,top:t.clientY});if(!l)return-1;let{pos:n}=l,o=j(e.state.doc.resolve(n));if(!o)return-1;if(r=="right")return o.pos;let s=w.get(o.node(-1)),a=o.start(-1),i=s.map.indexOf(o.pos-a);return i%s.width==0?-1:a+s.map[i-1]}function De(e,t,r){let l=t.clientX-e.startX;return Math.max(r,e.startWidth+l)}function ot(e,t){e.dispatch(e.state.tr.setMeta(k,{setHandle:t}))}function Bl(e,t,r){let l=e.state.doc.resolve(t),n=l.node(-1),o=w.get(n),s=l.start(-1),a=o.colCount(l.pos-s)+l.nodeAfter.attrs.colspan-1,i=e.state.tr;for(let d=0;d<o.height;d++){let u=d*o.width+a;if(d&&o.map[u]==o.map[u-o.width])continue;let c=o.map[u],{attrs:p}=n.nodeAt(c),h=p.colspan==1?0:a-o.colCount(c);if(p.colwidth&&p.colwidth[h]==r)continue;let f=p.colwidth?p.colwidth.slice():zl(p.colspan);f[h]=r,i.setNodeMarkup(s+c,null,M(p,"colwidth",f))}i.docChanged&&e.dispatch(i)}function _l(e,t,r,l){let n=e.state.doc.resolve(t),o=n.node(-1),s=n.start(-1),a=w.get(o).colCount(n.pos-s)+n.nodeAfter.attrs.colspan-1,i=e.domAtPos(n.start(-1)).node;for(;i.nodeName!="TABLE";)i=i.parentNode;we(o,i.firstChild,i,l,a,r)}function zl(e){let t=[];for(let r=0;r<e;r++)t.push(0);return t}function Il(e,t){let r=[],l=e.doc.resolve(t),n=l.node(-1),o=w.get(n),s=l.start(-1),a=o.colCount(l.pos-s)+l.nodeAfter.attrs.colspan;for(let i=0;i<o.height;i++){let d=a+i*o.width-1;if((a==o.width||o.map[d]!=o.map[d+1])&&(i==0||o.map[d-1]!=o.map[d-1-o.width])){let u=o.map[d],c=s+u+n.nodeAt(u).nodeSize-1,p=document.createElement("div");p.className="column-resize-handle",r.push(Xe.widget(c,p))}}return Ge.create(e.doc,r)}function El({allowTableNodeSelection:e=!1}={}){return new Ue({key:$,state:{init(){return null},apply(t,r){let l=t.getMeta($);if(l!=null)return l==-1?null:l;if(r==null||!t.docChanged)return r;let{deleted:n,pos:o}=t.mapping.mapResult(r);return n?null:o}},props:{decorations:qt,handleDOMEvents:{mousedown:sl},createSelectionBetween(t){if($.getState(t.state)!=null)return t.state.selection},handleTripleClick:nl,handleKeyDown:rl,handlePaste:ol},appendTransaction(t,r,l){return Zt(l,lt(l,r),e)}})}function We(e,t,r,l,n,o){let s=0,a=!0,i=t.firstChild;const d=e.firstChild;for(let u=0,c=0;u<d.childCount;u+=1){const{colspan:p,colwidth:h}=d.child(u).attrs;for(let f=0;f<p;f+=1,c+=1){const m=n===c?o:h&&h[f],b=m?`${m}px`:"";s+=m||l,m||(a=!1),i?(i.style.width!==b&&(i.style.width=b),i=i.nextSibling):t.appendChild(document.createElement("col")).style.width=b}}for(;i;){const u=i.nextSibling;i.parentNode.removeChild(i),i=u}a?(r.style.width=`${s}px`,r.style.minWidth=""):(r.style.width="",r.style.minWidth=`${s}px`)}class $l{constructor(t,r){this.node=t,this.cellMinWidth=r,this.dom=document.createElement("div"),this.dom.className="tableWrapper",this.table=this.dom.appendChild(document.createElement("table")),this.colgroup=this.table.appendChild(document.createElement("colgroup")),We(t,this.colgroup,this.table,r),this.contentDOM=this.table.appendChild(document.createElement("tbody"))}update(t){return t.type!==this.node.type?!1:(this.node=t,We(t,this.colgroup,this.table,this.cellMinWidth),!0)}ignoreMutation(t){return t.type==="attributes"&&(t.target===this.table||this.colgroup.contains(t.target))}}function Pe(e,t){return t?e.createChecked(null,t):e.createAndFill()}function Ol(e){if(e.cached.tableNodeTypes)return e.cached.tableNodeTypes;const t={};return Object.keys(e.nodes).forEach(r=>{const l=e.nodes[r];l.spec.tableRole&&(t[l.spec.tableRole]=l)}),e.cached.tableNodeTypes=t,t}function Dl(e,t,r,l,n){const o=Ol(e),s=[],a=[];for(let d=0;d<r;d+=1){const u=Pe(o.cell,n);if(u&&a.push(u),l){const c=Pe(o.header_cell,n);c&&s.push(c)}}const i=[];for(let d=0;d<t;d+=1)i.push(o.row.createChecked(null,l&&d===0?s:a));return o.table.createChecked(null,i)}function Wl(e){return e instanceof g}const ee=({editor:e})=>{const{selection:t}=e.state;if(!Wl(t))return!1;let r=0;const l=ht(t.ranges[0].$from,o=>o.type.name==="table");return l==null||l.node.descendants(o=>{if(o.type.name==="table")return!1;["tableCell","tableHeader"].includes(o.type.name)&&(r+=1)}),r===t.ranges.length?(e.commands.deleteTable(),!0):!1},Pl=x.create({name:"table",addOptions(){return{HTMLAttributes:{},resizable:!1,handleWidth:5,cellMinWidth:25,View:$l,lastColumnResizable:!0,allowTableNodeSelection:!1}},content:"tableRow+",tableRole:"table",isolating:!0,group:"block",parseHTML(){return[{tag:"table"}]},renderHTML({HTMLAttributes:e}){return["table",C(this.options.HTMLAttributes,e),["tbody",0]]},addCommands(){return{insertTable:({rows:e=3,cols:t=3,withHeaderRow:r=!0}={})=>({tr:l,dispatch:n,editor:o})=>{const s=Dl(o.schema,e,t,r);if(n){const a=l.selection.anchor+1;l.replaceSelectionWith(s).scrollIntoView().setSelection(O.near(l.doc.resolve(a)))}return!0},addColumnBefore:()=>({state:e,dispatch:t})=>dl(e,t),addColumnAfter:()=>({state:e,dispatch:t})=>ul(e,t),deleteColumn:()=>({state:e,dispatch:t})=>pl(e,t),addRowBefore:()=>({state:e,dispatch:t})=>hl(e,t),addRowAfter:()=>({state:e,dispatch:t})=>ml(e,t),deleteRow:()=>({state:e,dispatch:t})=>bl(e,t),deleteTable:()=>({state:e,dispatch:t})=>Tl(e,t),mergeCells:()=>({state:e,dispatch:t})=>ze(e,t),splitCell:()=>({state:e,dispatch:t})=>Ie(e,t),toggleHeaderColumn:()=>({state:e,dispatch:t})=>q("column")(e,t),toggleHeaderRow:()=>({state:e,dispatch:t})=>q("row")(e,t),toggleHeaderCell:()=>({state:e,dispatch:t})=>Al(e,t),mergeOrSplit:()=>({state:e,dispatch:t})=>ze(e,t)?!0:Ie(e,t),setCellAttribute:(e,t)=>({state:r,dispatch:l})=>Cl(e,t)(r,l),goToNextCell:()=>({state:e,dispatch:t})=>$e(1)(e,t),goToPreviousCell:()=>({state:e,dispatch:t})=>$e(-1)(e,t),fixTables:()=>({state:e,dispatch:t})=>(t&&lt(e),!0),setCellSelection:e=>({tr:t,dispatch:r})=>{if(r){const l=g.create(t.doc,e.anchorCell,e.headCell);t.setSelection(l)}return!0}}},addKeyboardShortcuts(){return{Tab:()=>this.editor.commands.goToNextCell()?!0:this.editor.can().addRowAfter()?this.editor.chain().addRowAfter().goToNextCell().run():!1,"Shift-Tab":()=>this.editor.commands.goToPreviousCell(),Backspace:ee,"Mod-Backspace":ee,Delete:ee,"Mod-Delete":ee}},addProseMirrorPlugins(){return[...this.options.resizable&&this.editor.isEditable?[Ll({handleWidth:this.options.handleWidth,cellMinWidth:this.options.cellMinWidth,View:this.options.View,lastColumnResizable:this.options.lastColumnResizable})]:[],El({allowTableNodeSelection:this.options.allowTableNodeSelection})]},extendNodeSchema(e){const t={name:e.name,options:e.options,storage:e.storage};return{tableRole:pt(ft(e,"tableRole",t))}}}),Fl=x.create({name:"tableCell",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"cell",isolating:!0,parseHTML(){return[{tag:"td"}]},renderHTML({HTMLAttributes:e}){return["td",C(this.options.HTMLAttributes,e),0]}}),jl=x.create({name:"tableHeader",addOptions(){return{HTMLAttributes:{}}},content:"block+",addAttributes(){return{colspan:{default:1},rowspan:{default:1},colwidth:{default:null,parseHTML:e=>{const t=e.getAttribute("colwidth");return t?[parseInt(t,10)]:null}}}},tableRole:"header_cell",isolating:!0,parseHTML(){return[{tag:"th"}]},renderHTML({HTMLAttributes:e}){return["th",C(this.options.HTMLAttributes,e),0]}}),Kl=x.create({name:"tableRow",addOptions(){return{HTMLAttributes:{}}},content:"(tableCell | tableHeader)*",tableRole:"row",parseHTML(){return[{tag:"tr"}]},renderHTML({HTMLAttributes:e}){return["tr",C(this.options.HTMLAttributes,e),0]}}),Vl=ie.create({name:"textAlign",addOptions(){return{types:[],alignments:["left","center","right","justify"],defaultAlignment:"left"}},addGlobalAttributes(){return[{types:this.options.types,attributes:{textAlign:{default:this.options.defaultAlignment,parseHTML:e=>e.style.textAlign||this.options.defaultAlignment,renderHTML:e=>e.textAlign===this.options.defaultAlignment?{}:{style:`text-align: ${e.textAlign}`}}}}]},addCommands(){return{setTextAlign:e=>({commands:t})=>this.options.alignments.includes(e)?this.options.types.every(r=>t.updateAttributes(r,{textAlign:e})):!1,unsetTextAlign:()=>({commands:e})=>this.options.types.every(t=>e.resetAttributes(t,"textAlign"))}},addKeyboardShortcuts(){return{"Mod-Shift-l":()=>this.editor.commands.setTextAlign("left"),"Mod-Shift-e":()=>this.editor.commands.setTextAlign("center"),"Mod-Shift-r":()=>this.editor.commands.setTextAlign("right"),"Mod-Shift-j":()=>this.editor.commands.setTextAlign("justify")}}}),Ul=I.create({name:"underline",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"u"},{style:"text-decoration",consuming:!1,getAttrs:e=>e.includes("underline")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["u",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setUnderline:()=>({commands:e})=>e.setMark(this.name),toggleUnderline:()=>({commands:e})=>e.toggleMark(this.name),unsetUnderline:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-u":()=>this.editor.commands.toggleUnderline(),"Mod-U":()=>this.editor.commands.toggleUnderline()}}}),Xl=x.create({name:"borderNumber",priority:1e3,group:"block",content:"borderNumberNumber borderNumberContent",parseHTML(){return[{tag:"border-number"}]},renderHTML(){return["border-number",{style:"display: flex; margin-bottom: 10px"},0]}}),Gl=x.create({name:"borderNumberNumber",priority:1e3,group:"border",content:"inline*",parseHTML(){return[{tag:"number"}]},renderHTML(){return["number",{style:"padding-left: 10px; min-width: 40px;"},0]}}),ql=x.create({name:"borderNumberContent",priority:1e3,group:"border",content:"block*",parseHTML(){return[{tag:"content"}]},renderHTML(){return["content",0]}}),Jl=x.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",C(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Fe=I.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",C(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const r=Ce(e,this.type);return Object.entries(r).some(([,n])=>!!n)?!0:t.unsetMark(this.name)}}}}),je=/^\s*([-+*])\s$/,Yl=x.create({name:"bulletList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},parseHTML(){return[{tag:"ul"}]},renderHTML({HTMLAttributes:e}){return["ul",C(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleBulletList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(Jl.name,this.editor.getAttributes(Fe.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-8":()=>this.editor.commands.toggleBulletList()}},addInputRules(){let e=se({find:je,type:this.type});return(this.options.keepMarks||this.options.keepAttributes)&&(e=se({find:je,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:()=>this.editor.getAttributes(Fe.name),editor:this.editor})),[e]}}),Zl=Yl.extend({addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),style:{default:null,parseHTML:t=>t.getAttribute("style"),renderHTML:t=>({style:t.style})}}}}),Ql=ie.create({name:"fontSize",addOptions(){return{types:["textStyle","paragraph"]}},addGlobalAttributes(){return[{types:this.options.types,attributes:{fontSize:{default:null,parseHTML:e=>{var t;return(t=e.style.fontSize)==null?void 0:t.replace(/['"]+/g,"")},renderHTML:e=>e.fontSize?{style:`font-size: ${e.fontSize}`}:{}}}}]},addCommands(){return{setFontSize:e=>({chain:t})=>t().setMark("textStyle",{fontSize:e}).run(),unsetFontSize:()=>({chain:e})=>e().setMark("textStyle",{fontSize:null}).removeEmptyTextStyle().run()}}}),er=/(?:^|\s)(!\[(.+|:?)]\((\S+)(?:(?:\s+)["'](\S+)["'])?\))$/,tr=x.create({name:"image",addOptions(){return{inline:!1,allowBase64:!1,HTMLAttributes:{}}},inline(){return this.options.inline},group(){return this.options.inline?"inline":"block"},draggable:!0,addAttributes(){return{src:{default:null},alt:{default:null},title:{default:null}}},parseHTML(){return[{tag:this.options.allowBase64?"img[src]":'img[src]:not([src^="data:"])'}]},renderHTML({HTMLAttributes:e}){return["img",C(this.options.HTMLAttributes,e)]},addCommands(){return{setImage:e=>({commands:t})=>t.insertContent({type:this.name,attrs:e})}},addInputRules(){return[mt({find:er,type:this.type,getAttributes:e=>{const[,,t,r,l]=e;return{src:r,alt:t,title:l}}})]}}),lr=tr.extend({addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),width:{default:null},height:{default:null},style:{default:null}}}}),rr=x.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",C(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),nr=e=>{const t=!!e.firstChild&&e.firstChild.tagName.toLowerCase()==="p",r=!!e.childNodes[1]&&e.childNodes[1].tagName.toLowerCase()==="p";if(t&&!r){const l=document.createElement("p");l.style.display="table-cell",l.textContent="",e.insertBefore(l,e.firstChild)}},or=rr.extend({addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),style:{default:null,parseHTML:t=>(t.tagName.toLowerCase()==="li"&&nr(t),t.getAttribute("style")),renderHTML:t=>({style:t.style})}}}}),sr=x.create({name:"listItem",addOptions(){return{HTMLAttributes:{}}},content:"paragraph block*",defining:!0,parseHTML(){return[{tag:"li"}]},renderHTML({HTMLAttributes:e}){return["li",C(this.options.HTMLAttributes,e),0]},addKeyboardShortcuts(){return{Enter:()=>this.editor.commands.splitListItem(this.name),Tab:()=>this.editor.commands.sinkListItem(this.name),"Shift-Tab":()=>this.editor.commands.liftListItem(this.name)}}}),Ke=I.create({name:"textStyle",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"span",getAttrs:e=>e.hasAttribute("style")?{}:!1}]},renderHTML({HTMLAttributes:e}){return["span",C(this.options.HTMLAttributes,e),0]},addCommands(){return{removeEmptyTextStyle:()=>({state:e,commands:t})=>{const r=Ce(e,this.type);return Object.entries(r).some(([,n])=>!!n)?!0:t.unsetMark(this.name)}}}}),Ve=/^(\d+)\.\s$/,ir=x.create({name:"orderedList",addOptions(){return{itemTypeName:"listItem",HTMLAttributes:{},keepMarks:!1,keepAttributes:!1}},group:"block list",content(){return`${this.options.itemTypeName}+`},addAttributes(){return{start:{default:1,parseHTML:e=>e.hasAttribute("start")?parseInt(e.getAttribute("start")||"",10):1}}},parseHTML(){return[{tag:"ol"}]},renderHTML({HTMLAttributes:e}){const{start:t,...r}=e;return t===1?["ol",C(this.options.HTMLAttributes,r),0]:["ol",C(this.options.HTMLAttributes,e),0]},addCommands(){return{toggleOrderedList:()=>({commands:e,chain:t})=>this.options.keepAttributes?t().toggleList(this.name,this.options.itemTypeName,this.options.keepMarks).updateAttributes(sr.name,this.editor.getAttributes(Ke.name)).run():e.toggleList(this.name,this.options.itemTypeName,this.options.keepMarks)}},addKeyboardShortcuts(){return{"Mod-Shift-7":()=>this.editor.commands.toggleOrderedList()}},addInputRules(){let e=se({find:Ve,type:this.type,getAttributes:t=>({start:+t[1]}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1]});return(this.options.keepMarks||this.options.keepAttributes)&&(e=se({find:Ve,type:this.type,keepMarks:this.options.keepMarks,keepAttributes:this.options.keepAttributes,getAttributes:t=>({start:+t[1],...this.editor.getAttributes(Ke.name)}),joinPredicate:(t,r)=>r.childCount+r.attrs.start===+t[1],editor:this.editor})),[e]}}),ar=ir.extend({addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),style:{default:null,parseHTML:t=>t.getAttribute("style"),renderHTML:t=>({style:t.style})}}}}),dr=gt.extend({addAttributes(){var e;return{...(e=this.parent)==null?void 0:e.call(this),class:{default:null},listIndexStyle:{default:null,parseHTML:t=>t.getAttribute("style"),renderHTML:t=>{if(t.style===null)return{};const r=[...new Set(JSON.stringify(t.listIndexStyle).replace(/"/g,"").split(";").map(i=>i.trim()).filter(i=>i.length>0&&(i.includes("display")||i.includes("text-align"))))],l=r.filter(i=>i.includes("display")),n=l.length>0?l[l.length-1]+";":"",o=r.filter(i=>i.includes("text-align")),s=!JSON.stringify(t).includes("textAlign")&&o.length>0?o[o.length-1]+";":"",a=n+s;return a.length>0?{style:a}:{}}}}}}),ur=I.create({name:"subscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sub"},{style:"vertical-align",getAttrs(e){return e!=="sub"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sub",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setSubscript:()=>({commands:e})=>e.setMark(this.name),toggleSubscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSubscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-,":()=>this.editor.commands.toggleSubscript()}}}),cr=I.create({name:"superscript",addOptions(){return{HTMLAttributes:{}}},parseHTML(){return[{tag:"sup"},{style:"vertical-align",getAttrs(e){return e!=="super"?!1:null}}]},renderHTML({HTMLAttributes:e}){return["sup",C(this.options.HTMLAttributes,e),0]},addCommands(){return{setSuperscript:()=>({commands:e})=>e.setMark(this.name),toggleSuperscript:()=>({commands:e})=>e.toggleMark(this.name),unsetSuperscript:()=>({commands:e})=>e.unsetMark(this.name)}},addKeyboardShortcuts(){return{"Mod-.":()=>this.editor.commands.toggleSuperscript()}}}),pr=cr.extend({priority:1e4}),fr=ur.extend({priority:1e4}),hr=ie.create({addGlobalAttributes(){return[{types:["table","tableRow","tableCell","tableHeader,"],attributes:{style:{renderHTML:e=>({style:e.style})}}}]}}),mr=["aria-label"],gr={key:0,class:"absolute bg-white border-1 border-blue-800 border-solid flex flex-row mt-80 pa-1 z-50"},br=["aria-label","onClick","onKeydown"],yr={class:"leading-default material-icons px-2"},wr=qe({__name:"TextEditorButton",props:{type:null,icon:null,ariaLabel:null,childButtons:null,isLast:{type:Boolean},isActive:{type:Boolean},isSecondRow:{type:Boolean},isCollapsable:{type:Boolean},callback:{type:Function}},emits:["toggle"],setup(e,{emit:t}){const r=e,l=V(!1);function n(s){!s.childButtons||s.type==="more"?t("toggle",s):s.type==="menu"&&(l.value=!l.value)}const o=s=>{if(r.type){const a=document.querySelector(`#${r.type}`);if(a==null||s.target===a||s.target.id==="menu")return;l.value=!1}};return Je(()=>{document.addEventListener("click",o)}),bt(()=>{document.removeEventListener("click",o)}),(s,a)=>(L(),R("div",{"aria-label":e.ariaLabel,class:te(["cursor-pointer editor-button flex flex-row-reverse hover:bg-blue-200 items-center text-blue-900",{"bg-blue-200":e.isActive&&!e.childButtons,"border-r-1 border-gray-400 border-solid":e.isLast}]),onClick:a[1]||(a[1]=i=>n(r)),onKeydown:a[2]||(a[2]=xe(i=>n(r),["m"])),onMousedown:a[3]||(a[3]=Le(()=>{},["prevent"]))},[z("span",{class:te(["leading-default px-[0.5rem]",{dropdown:e.type=="menu","material-icons":e.icon}])},Te(e.icon),3),l.value?(L(),R("div",gr,[(L(!0),R(le,null,re(e.childButtons,(i,d)=>(L(),R("div",{key:d,"aria-label":i.ariaLabel,class:te(["cursor-pointer dropdown-item hover:bg-blue-200 text-blue-900 z-50",{"bg-blue-200":e.isActive,"bg-red-800":e.isSecondRow}]),onClick:u=>t("toggle",i),onKeydown:xe(u=>t("toggle",i),["m"]),onMousedown:a[0]||(a[0]=Le(()=>{},["prevent"]))},[z("span",yr,Te(i.icon),1)],42,br))),128))])):he("",!0)],42,mr))}});const fe=Ye(wr,[["__scopeId","data-v-a2673eb7"]]);function Cr(e){for(let t=1;t<e.length;t++)e[t].group!==e[t-1].group&&(e[t-1].isLast=!0)}function st(e){let t=[];return e.forEach(function(r){r.type!=="menu"&&t.push(r),r.childButtons instanceof Array&&(t=t.concat(st(r.childButtons)))}),t}function Mr(e,t){return{collapsedButtons:ne(()=>{let l=new Array(...e.value);for(;l.length>t.value;){const n=l.filter(d=>d.group!=null&&d.isCollapsable===!0);if(n.length==0){const d=st(l),u=d.filter(p=>p.isSecondRow),c={type:"more",icon:"more_horiz",ariaLabel:"more",isCollapsable:!1,childButtons:u};return l=d.filter(p=>!u.includes(p)),l.push(c),l}const o=n[n.length-1].group,s=l.filter(d=>d.group==o),a=l.indexOf(s[0]);l=l.filter(d=>!s.includes(d));const i={type:"menu",icon:s[0].icon,ariaLabel:"menu",group:s[0].group,isCollapsable:!1,childButtons:s};l.splice(a,0,i)}return Cr(l),l})}}const it=e=>(Tt("data-v-e92026dd"),e=e(),xt(),e),Ar={key:0},Sr=["aria-label"],Tr={class:"flex flex-row"},xr={class:"flex flex-row"},Lr=it(()=>z("hr",null,null,-1)),kr={key:1},Hr=["aria-label"],Rr=it(()=>z("hr",null,null,-1)),vr=qe({__name:"TextEditor",props:{value:{default:void 0},fieldSize:{default:"small"},editable:{type:Boolean,default:!1},ariaLabel:{default:"Editor Feld"}},emits:["updateValue"],setup(e,{emit:t}){const r=e,l=V(!1),n=new yt({editorProps:{attributes:{tabindex:"0",style:"height: 100%; overflow-y: auto; padding: 0.75rem 1rem; outline: 0"}},content:r.value,extensions:[wt,dr,Ct,Xl,Gl,ql,vt,Bt,Ql,$t,or,Zl,ar,Ul,Wt,fr,pr,Pl,Fl,jl,Kl,hr,Nt,Vl.configure({types:["paragraph","span"]}),lr.configure({allowBase64:!0,inline:!0,HTMLAttributes:{class:"inline align-baseline"}}),Mt.configure({depth:100})],onUpdate:()=>{t("updateValue",n.getHTML())},onFocus:()=>l.value=!0,onBlur:()=>l.value=!1,editable:r.editable,parseOptions:{preserveWhitespace:"full"}}),o=ne(()=>[{type:"undo",icon:"undo",ariaLabel:"undo",group:"arrow",isCollapsable:!1,callback:()=>n.chain().focus().undo().run()},{type:"redo",icon:"redo",ariaLabel:"redo",group:"arrow",isCollapsable:!1,callback:()=>n.chain().focus().redo().run()},{type:"bold",icon:"format_bold",ariaLabel:"bold",group:"format",isCollapsable:!1,callback:()=>n.chain().focus().toggleMark("bold").run()},{type:"italic",icon:"format_italic",ariaLabel:"italic",group:"format",isCollapsable:!1,callback:()=>n.chain().focus().toggleMark("italic").run()},{type:"underline",icon:"format_underlined",ariaLabel:"underline",group:"format",isCollapsable:!1,callback:()=>n.chain().focus().toggleMark("underline").run()},{type:"strike",icon:"strikethrough_s",ariaLabel:"strike",group:"format",isCollapsable:!1,callback:()=>n.chain().focus().toggleMark("strike").run()},{type:"left",icon:"format_align_left",ariaLabel:"left",group:"alignment",isCollapsable:!0,isSecondRow:!0,callback:()=>n.chain().focus().setTextAlign("left").run()},{type:"center",icon:"format_align_center",ariaLabel:"center",group:"alignment",isCollapsable:!0,isSecondRow:!0,callback:()=>n.chain().focus().setTextAlign("center").run()},{type:"right",icon:"format_align_right",ariaLabel:"right",group:"alignment",isCollapsable:!0,isSecondRow:!0,callback:()=>n.chain().focus().setTextAlign("right").run()},{type:"justify",icon:"format_align_justify",ariaLabel:"justify",group:"alignment",isCollapsable:!0,isSecondRow:!0,callback:()=>n.chain().focus().setTextAlign("justify").run()},{type:"superscript",icon:"superscript",ariaLabel:"superscript",group:"vertical-alignment",isCollapsable:!1,isSecondRow:!0,callback:()=>n.chain().focus().toggleMark("superscript").run()},{type:"subscript",icon:"subscript",ariaLabel:"subscript",group:"vertical-alignment",isCollapsable:!1,isSecondRow:!0,callback:()=>n.chain().focus().toggleMark("subscript").run()},{type:"numbered-list",icon:"format_list_numbered",ariaLabel:"numbered-list",group:"list",isCollapsable:!0,isSecondRow:!0},{type:"bullet-list",icon:"format_list_bulleted",ariaLabel:"bullet-list",group:"list",isCollapsable:!0,isSecondRow:!0},{type:"vertical_split",icon:"vertical_split",ariaLabel:"vertical_split",group:"split",isCollapsable:!0,isSecondRow:!0},{type:"vertical_split",icon:"vertical_split",ariaLabel:"vertical_split",group:"split",isCollapsable:!0,isSecondRow:!0},{type:"table",icon:"table_chart",ariaLabel:"table",isCollapsable:!1,isSecondRow:!0}]),s=[{type:"",icon:"123",ariaLabel:"margins"},{type:"",icon:"open_in_full",ariaLabel:"fullview"}],a=ne(()=>o.value.map(y=>({...y,isActive:y.group=="alignment"?n.isActive({textAlign:y.type}):n.isActive(y.type)}))),i=48,d=V(),u=ne(()=>Math.floor((d.value-100)/i)),{collapsedButtons:c}=Mr(a,u),p=V(!1),h=V();function f(y){y.type=="more"&&(p.value=!p.value),y.callback&&y.callback()}At(()=>r.value,y=>{!y||y===n.getHTML()||n.commands.setContent(y,!1)});const m=()=>r.editable&&l.value,b=r.ariaLabel?r.ariaLabel:null;Je(()=>{const y=document.querySelector(".editor");y!=null&&S.observe(y)});const S=new ResizeObserver(y=>{p.value=!1;for(const E of y)d.value=E.contentRect.width});return(y,E)=>(L(),R("div",{ref_key:"container",ref:h,class:"bg-white editor",fluid:""},[m()?(L(),R("div",Ar,[z("div",{"aria-label":r.ariaLabel+" Button Leiste",class:"flex flex-row flex-wrap justify-between pa-1"},[z("div",Tr,[(L(!0),R(le,null,re(W(c),(B,T)=>(L(),ke(fe,ue({key:T},B,{onToggle:f}),null,16))),128))]),z("div",xr,[(L(),R(le,null,re(s,(B,T)=>He(fe,ue({key:T},B,{onToggle:f}),null,16)),64))])],8,Sr),Lr])):he("",!0),m()&&p.value?(L(),R("div",kr,[z("div",{"aria-label":W(b)+" Editor Button Leiste",class:"flex flex-row flex-wrap pa-1"},[(L(!0),R(le,null,re(W(c)[W(c).length-1].childButtons,(B,T)=>(L(),ke(fe,ue({key:T},B,{onToggle:f}),null,16))),128))],8,Hr),Rr])):he("",!0),z("div",null,[He(W(St),{class:te("editor-content editor-content--"+e.fieldSize),"data-testid":W(b),editor:W(n)},null,8,["class","data-testid","editor"])])],512))}});const _r=Ye(vr,[["__scopeId","data-v-e92026dd"]]),zr={async upload(e,t){var n;const r=(n=t.name)==null?void 0:n.split(".").pop();if(!r||r.toLowerCase()!=="docx")return{status:415,error:{title:"Das ausgewhlte Dateiformat ist nicht korrekt.",description:"Versuchen Sie eine .docx-Version dieser Datei hochzuladen."}};const l=await ce.put(`caselaw/documentunits/${e}/file`,{headers:{"Content-Type":"application/vnd.openxmlformats-officedocument.wordprocessingml.document","X-Filename":t.name}},t);return l.error=l.status===413?{title:"Die Datei darf max. 20 MB gro sein.",description:"Bitte laden Sie eine kleinere Datei hoch."}:l.status===415?{title:"Das ausgewhlte Dateiformat ist nicht korrekt.",description:"Versuchen Sie eine .docx-Version dieser Datei hochzuladen."}:l.status>=300?{title:"Leider ist ein Fehler aufgetreten.",description:"Bitte versuchen Sie es zu einem spteren Zeitpunkt erneut."}:void 0,l},async delete(e){const t=await ce.delete(`caselaw/documentunits/${e}/file`);return t.error=t.status>=300?{title:"Datei konnte nicht gelscht werden."}:void 0,t},async getDocxFileAsHtml(e){const t=await ce.get(`caselaw/documentunitdocx/${e}`);return t.error=t.status>=300?{title:"Docx konnte nicht als html geladen werden."}:void 0,t}};export{_r as T,zr as s};
